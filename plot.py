import math
import matplotlib.pyplot as plt

smoothing_percent = 0.1

losses = [0.953582763671875,1.1535440683364868,1.0393613576889038,0.9807332754135132,0.9095578789710999,0.8260700106620789,0.6832476854324341,0.8077895045280457,0.7510967254638672,0.6161562204360962,0.62376469373703,0.5744695663452148,0.5352597236633301,0.4568959176540375,0.6446512341499329,0.5733119249343872,0.5057052373886108,0.4888646602630615,0.5876091718673706,0.3675871789455414,0.3712410628795624,0.42343422770500183,0.3543951213359833,0.39542439579963684,0.30715104937553406,0.305586040019989,0.5077027082443237,0.31617471575737,0.4710667133331299,0.49573537707328796,0.38564786314964294,0.25683286786079407,0.3234579563140869,0.3436099886894226,0.3158370852470398,0.32750216126441956,0.21560770273208618,0.346767783164978,0.23507457971572876,0.22206690907478333,0.2880200743675232,0.3301571309566498,0.2526508569717407,0.2055869847536087,0.26947087049484253,0.2864975035190582,0.33362263441085815,0.36518004536628723,0.21136295795440674,0.2857193052768707,0.30618855357170105,0.46552541851997375,0.22557227313518524,0.33096590638160706,0.2530445456504822,0.21817438304424286,0.2694742679595947,0.34369271993637085,0.2624390721321106,0.2431311309337616,0.17775335907936096,0.2182929962873459,0.2681771218776703,0.15481789410114288,0.14227630198001862,0.28686216473579407,0.13435834646224976,0.28481194376945496,0.3065933287143707,0.21112830936908722,0.2701037526130676,0.15687672793865204,0.2654077708721161,0.23522180318832397,0.206391379237175,0.2591966390609741,0.24233728647232056,0.1782447099685669,0.2312648892402649,0.1832583099603653,0.23070107400417328,0.2699955701828003,0.22967402637004852,0.15772703289985657,0.16321773827075958,0.24352331459522247,0.2471708506345749,0.3135891854763031,0.24708378314971924,0.1751382052898407,0.21743161976337433,0.1034480482339859,0.16265477240085602,0.2650637626647949,0.08811390399932861,0.20851166546344757,0.21750184893608093,0.18906104564666748,0.17394313216209412,0.23982608318328857,0.09380260854959488,0.1767963469028473,0.08152348548173904,0.12113429605960846,0.1430186927318573,0.17288875579833984,0.199123814702034,0.16949279606342316,0.18398083746433258,0.14810270071029663,0.15963350236415863,0.1438014656305313,0.18558023869991302,0.1747691035270691,0.1591414213180542,0.21748453378677368,0.16658037900924683,0.1188732385635376,0.24431771039962769,0.16303125023841858,0.2421928495168686,0.16091220080852509,0.17829765379428864,0.12486188113689423,0.0784594714641571,0.1698053628206253,0.20422914624214172,0.2262846678495407,0.10513702034950256,0.19441059231758118,0.1907307505607605,0.17066019773483276,0.1442338079214096,0.1490296870470047,0.15407387912273407,0.103549525141716,0.11847780644893646,0.11168520897626877,0.14352378249168396,0.07947637140750885,0.2455751746892929,0.10375507920980453,0.19350430369377136,0.15077689290046692,0.21274082362651825,0.12488815188407898,0.14073367416858673,0.07693329453468323,0.13940462470054626,0.1392628401517868,0.17476113140583038,0.1401742845773697,0.13536708056926727,0.15686900913715363,0.10051431506872177,0.12498988956212997,0.19375713169574738,0.14716167747974396,0.1025056317448616,0.10232984274625778,0.09597854316234589,0.07146743685007095,0.18492357432842255,0.1483181118965149,0.23712395131587982,0.10214561969041824,0.0594131238758564,0.16749151051044464,0.12397468835115433,0.1440737247467041,0.1681167036294937,0.2083941102027893,0.12175487726926804,0.10243922472000122,0.13936054706573486,0.10428254306316376,0.09282620251178741,0.1886976808309555,0.18622750043869019,0.18213288486003876,0.04827525094151497,0.1295463740825653,0.1326920986175537,0.1842559278011322,0.14054055511951447,0.2236206978559494,0.14843213558197021,0.21820038557052612,0.17289592325687408,0.15211538970470428,0.14193730056285858,0.16128312051296234,0.13293606042861938,0.15434829890727997,0.11950372159481049,0.1660114973783493,0.2152627408504486,0.09297000616788864,0.23855209350585938,0.22240646183490753,0.1177377998828888,0.16816917061805725,0.06824803352355957,0.19880859553813934,0.11323674023151398,0.20888304710388184,0.133591428399086,0.12365471571683884,0.11384227871894836,0.21529562771320343,0.11751414835453033,0.14564207196235657,0.129587784409523,0.104076087474823,0.059666238725185394,0.11104567348957062,0.12560077011585236,0.1615106463432312,0.12687283754348755,0.10962194949388504,0.18384404480457306,0.17579111456871033,0.1065245121717453,0.10451854765415192,0.14258456230163574,0.1140432059764862,0.10891306400299072,0.0970151498913765,0.11551110446453094,0.15526700019836426,0.13357222080230713,0.06999871879816055,0.13105814158916473,0.18060527741909027,0.07218798995018005,0.13877633213996887,0.10924345254898071,0.22426019608974457,0.12000038474798203,0.12360372394323349,0.1531161516904831,0.0772579163312912,0.06430144608020782,0.17328613996505737,0.09641246497631073,0.11208737641572952,0.14688922464847565,0.15318821370601654,0.08559197932481766,0.08721966296434402,0.13755351305007935,0.14283829927444458,0.060395557433366776,0.09772078692913055,0.0924006998538971,0.12290479242801666,0.12560175359249115,0.10576696693897247,0.19321346282958984,0.15994742512702942,0.23090583086013794,0.24458803236484528,0.1833375245332718,0.13870523869991302,0.05191189423203468,0.18718592822551727,0.15927839279174805,0.15650255978107452,0.14271004498004913,0.11199740320444107,0.13497281074523926,0.14654751121997833,0.10480280965566635,0.11302582174539566,0.13494735956192017,0.13065315783023834,0.09960447996854782,0.16392971575260162,0.2563611567020416,0.11496636271476746,0.14062951505184174,0.14387010037899017,0.051395244896411896,0.07187915593385696,0.08612118661403656,0.11148782819509506,0.07122866064310074,0.16076327860355377,0.05538887158036232,0.21933099627494812,0.16400279104709625,0.1834414303302765,0.10237956047058105,0.05690060183405876,0.21801407635211945,0.19798429310321808,0.05557926744222641,0.10866540670394897,0.14213420450687408,0.12929044663906097,0.05439367890357971,0.0779876634478569,0.14824087917804718,0.16010329127311707,0.053574446588754654,0.10524460673332214,0.0915754958987236,0.03488616645336151,0.13905994594097137,0.12377238273620605,0.18303996324539185,0.12825417518615723,0.08084157109260559,0.1114361360669136,0.09202558547258377,0.082199826836586,0.15405389666557312,0.0847288966178894,0.114505834877491,0.17547506093978882,0.12618306279182434,0.11599758267402649,0.093375563621521,0.09175142645835876,0.08450806885957718,0.09554502367973328,0.1096784770488739,0.06600569188594818,0.13950207829475403,0.0818573459982872,0.16634692251682281,0.0548279844224453,0.05858139321208,0.082792267203331,0.08564834296703339,0.1336323469877243,0.07136035710573196,0.10723858326673508,0.1253945678472519,0.08540181070566177,0.1355518400669098,0.13758480548858643,0.10819100588560104,0.13624782860279083,0.19497966766357422,0.1583699733018875,0.09179873764514923,0.09544152766466141,0.08633865416049957,0.1256299614906311,0.17369139194488525,0.05483080819249153,0.14117585122585297,0.14646248519420624,0.08369573205709457,0.13103380799293518,0.04771098122000694,0.10390070080757141,0.10254070162773132,0.08591272681951523,0.13449697196483612,0.04204699769616127,0.1273149847984314,0.12147033214569092,0.05303647741675377,0.12772899866104126,0.08322562277317047,0.08370959013700485,0.1029263436794281,0.1680978536605835,0.10225153714418411,0.11334842443466187,0.12550504505634308,0.1557019203901291,0.0904657170176506,0.10461614280939102,0.07557749003171921,0.12939773499965668,0.12436719238758087,0.11105372756719589,0.11207015067338943,0.11638780683279037,0.20091195404529572,0.14398051798343658,0.09346196055412292,0.13776254653930664,0.0804913192987442,0.17535604536533356,0.10537248849868774,0.07519989460706711,0.1104573979973793,0.13751815259456635,0.07352171838283539,0.11576614528894424,0.13059544563293457,0.09134361147880554,0.22781389951705933,0.05990079790353775,0.1483187973499298,0.15890735387802124,0.05202605202794075,0.1576882153749466,0.056091099977493286,0.13263556361198425,0.051496513187885284,0.09854551404714584,0.07818306982517242,0.07951957732439041,0.09000447392463684,0.12443029135465622,0.06879402697086334,0.12110964953899384,0.10631927847862244,0.15216480195522308,0.14687936007976532,0.12047550827264786,0.12477926909923553,0.07632847875356674,0.06865736097097397,0.13632087409496307,0.08641216903924942,0.1109764575958252,0.07731977850198746,0.06755749136209488,0.04321717098355293,0.16102397441864014,0.10510978102684021,0.07033765316009521,0.18755176663398743,0.09763389825820923,0.0893138200044632,0.07106402516365051,0.12480933964252472,0.13677138090133667,0.09061894565820694,0.09342572838068008,0.08599556237459183,0.07595555484294891,0.11513559520244598,0.11785252392292023,0.05798577889800072,0.052234843373298645,0.08474188297986984,0.13402312994003296,0.11322006583213806,0.06468609720468521,0.17883431911468506,0.11111728101968765,0.14091220498085022,0.1062149628996849,0.0896671935915947,0.06675112247467041,0.13029012084007263,0.03580552339553833,0.11730869114398956,0.1343909502029419,0.1099376305937767,0.10711075365543365,0.1266932338476181,0.09213421493768692,0.12319689244031906,0.10139482468366623,0.039635419845581055,0.17333874106407166,0.11558979004621506,0.07987596839666367,0.06849268823862076,0.08525477349758148,0.12250375002622604,0.10368338227272034,0.05032462254166603,0.09038291871547699,0.15149511396884918,0.15642860531806946,0.1879449039697647,0.11520368605852127,0.1144363060593605,0.04524950683116913,0.11967913806438446,0.07902835309505463,0.1126570850610733,0.10399577766656876,0.090614914894104,0.11900908499956131,0.10966506600379944,0.13147784769535065,0.11108537763357162,0.12718752026557922,0.13508614897727966,0.04320892319083214,0.1527186781167984,0.11953917145729065,0.05064772441983223,0.07869815081357956,0.07297708839178085,0.08371484279632568,0.08908525109291077,0.050815604627132416,0.05893213301897049,0.06143210828304291,0.10397933423519135,0.12849241495132446,0.06543231755495071,0.11515854299068451,0.08675146102905273,0.05706855282187462,0.07039377093315125,0.10218911617994308,0.07972460240125656,0.05949472263455391,0.133261039853096,0.06592796742916107,0.056720294058322906,0.08810397982597351,0.17390882968902588,0.0836980938911438,0.060720138251781464,0.08563817292451859,0.10697370022535324,0.06750595569610596,0.033149778842926025,0.13601969182491302,0.07970470935106277,0.07213634252548218,0.0719628632068634,0.1332891285419464,0.08469240367412567,0.08576793223619461,0.09025673568248749,0.1504267007112503,0.0746464803814888,0.08334573358297348,0.08041444420814514,0.04056677222251892,0.06421259790658951,0.021819278597831726,0.0670616403222084,0.13687235116958618,0.12295927852392197,0.11893148720264435,0.20423801243305206,0.0775284469127655,0.08095107227563858,0.13427597284317017,0.0873372033238411,0.09018026292324066,0.04229995235800743,0.08127709478139877,0.054523397237062454,0.07932087779045105,0.0744626447558403,0.12962797284126282,0.04812370613217354,0.10877838730812073,0.17107070982456207,0.18630562722682953,0.09746967256069183,0.0835835337638855,0.17913371324539185,0.11073900759220123,0.05479499697685242,0.04306194558739662,0.0731467753648758,0.11405978351831436,0.113481804728508,0.0775228962302208,0.09075972437858582,0.04209700599312782,0.07337126135826111,0.07895222306251526,0.07071655988693237,0.109700508415699,0.07927214354276657,0.1293991506099701,0.025033462792634964,0.0838853195309639,0.060614392161369324,0.09457045793533325,0.11993249505758286,0.08314161747694016,0.10137679427862167,0.14123250544071198,0.11678235977888107,0.0721212774515152,0.03710869699716568,0.09587860107421875,0.12056964635848999,0.0642964094877243,0.1360180675983429,0.09276148676872253,0.08269131928682327,0.1466764509677887,0.09049469977617264,0.06696717441082001,0.07286703586578369,0.15473969280719757,0.08134017139673233,0.0818106085062027,0.07727400213479996,0.10975942760705948,0.050153493881225586,0.12344406545162201,0.12923769652843475,0.05661310628056526,0.08079033344984055,0.06655462086200714,0.08609186112880707,0.10041528195142746,0.11684025824069977,0.05007558688521385,0.09272506833076477,0.12332324683666229,0.12753328680992126,0.07197286933660507,0.07056699693202972,0.07345809042453766,0.10120023787021637,0.10805875808000565,0.05491678789258003,0.05407152697443962,0.12292331457138062,0.11199403554201126,0.11249518394470215,0.06896275281906128,0.08166779577732086,0.09724246710538864,0.06141238659620285,0.0830477848649025,0.03584633022546768,0.06696899235248566,0.03774523735046387,0.07641737908124924,0.08961115777492523,0.13094107806682587,0.051600441336631775,0.12968823313713074,0.06842045485973358,0.05024830251932144,0.08839718252420425,0.05202195793390274,0.07441049814224243,0.07125043869018555,0.09072872251272202,0.12530390918254852,0.1271408647298813,0.07272084802389145,0.090012326836586,0.06822702288627625,0.06665586680173874,0.05164986848831177,0.0541367270052433,0.040710702538490295,0.07964178919792175,0.06873489916324615,0.0908096507191658,0.15643474459648132,0.04777747765183449,0.14884446561336517,0.09274359047412872,0.12170232087373734,0.08913137018680573,0.0247948057949543,0.047772135585546494,0.048456646502017975,0.15269486606121063,0.12277408689260483,0.12549783289432526,0.016790440306067467,0.09611315280199051,0.07757996022701263,0.044590063393116,0.08434055000543594,0.07824347168207169,0.07398826628923416,0.1663719117641449,0.05635304003953934,0.06382131576538086,0.0658223107457161,0.08737368881702423,0.0818098708987236,0.07052473723888397,0.0956256315112114,0.07001753896474838,0.10010426491498947,0.07561197876930237,0.11319059133529663,0.10297482460737228,0.08055294305086136,0.0799027681350708,0.07297562062740326,0.06499645113945007,0.0439269058406353,0.0359870120882988,0.09542703628540039,0.14099591970443726,0.06281775236129761,0.043181322515010834,0.09606931358575821,0.06517256796360016,0.0685761496424675,0.0677546039223671,0.0324518159031868,0.06812886148691177,0.1051507219672203,0.03672758489847183,0.09893480688333511,0.05764686316251755,0.08872498571872711,0.06533052772283554,0.06591083109378815,0.12776923179626465,0.08501578122377396,0.06330683082342148,0.025030922144651413,0.05286385864019394,0.03430908918380737,0.04212376847863197,0.09863623976707458,0.08874412626028061,0.13327158987522125,0.09643317759037018,0.05813552811741829,0.05486731603741646,0.0632505714893341,0.027812493965029716,0.0777556449174881,0.09380321204662323,0.0542035847902298,0.08909428119659424,0.059127967804670334,0.07959195226430893,0.04283357039093971,0.06319763511419296,0.10157804936170578,0.07537847012281418,0.044639553874731064,0.06817351281642914,0.1399824023246765,0.039775289595127106,0.042713381350040436,0.14331184327602386,0.06470842659473419,0.07405957579612732,0.06853453814983368,0.06893209367990494,0.029223265126347542,0.1505323350429535,0.05277056619524956,0.057616084814071655,0.06805862486362457,0.09030803292989731,0.05979461967945099,0.09011446684598923,0.07477133721113205,0.03948294371366501,0.06326759606599808,0.05467619001865387,0.07392476499080658,0.05895695090293884,0.04399190470576286,0.05467134714126587,0.10002380609512329,0.12055578082799911,0.07328122109174728,0.07063082605600357,0.09531142562627792,0.09060811996459961,0.11255482584238052,0.09327453374862671,0.10391370207071304,0.0989777073264122,0.04663160815834999,0.08034922927618027,0.0637783408164978,0.051145944744348526,0.11568112671375275,0.07312699407339096,0.11750022321939468,0.054446425288915634,0.08531402796506882,0.039712198078632355,0.05611294135451317,0.09243050962686539,0.05100760608911514,0.09814228117465973,0.07943727821111679,0.11448327451944351,0.1410975158214569,0.043348878622055054,0.1408778727054596,0.08198534697294235,0.11034023761749268,0.06045735254883766,0.11534373462200165,0.09305987507104874,0.0607425756752491,0.06122388318181038,0.07617674022912979,0.04706098139286041,0.08197428286075592,0.11499909311532974,0.12651032209396362,0.09161440283060074,0.11790113151073456,0.10404139757156372,0.08395906537771225,0.06198100373148918,0.04331747069954872,0.06058814004063606,0.04184047132730484,0.0662132054567337,0.07326984405517578,0.06727629899978638,0.11444315314292908,0.0986206978559494,0.07638490945100784,0.05756106600165367,0.01736232452094555,0.06768843531608582,0.055751580744981766,0.056207649409770966,0.09442826360464096,0.09024735540151596,0.04136088490486145,0.07145942747592926,0.034782182425260544,0.0653422474861145,0.08551027625799179,0.04645003005862236,0.06164180114865303,0.06480748951435089,0.07648197561502457,0.061225440353155136,0.026664532721042633,0.03908299282193184,0.039365336298942566,0.05730000510811806,0.05173642560839653,0.07000083476305008,0.02978464402258396,0.05194476619362831,0.05620136857032776,0.056071098893880844,0.04897528886795044,0.02521524392068386,0.04932994395494461,0.0971163660287857,0.09491682797670364,0.08695748448371887,0.04024608060717583,0.07565876096487045,0.06082991138100624,0.13303865492343903,0.05832427740097046,0.05836977809667587,0.029066896066069603,0.0775190070271492,0.03790345415472984,0.041671495884656906,0.036615125834941864,0.040015701204538345,0.0664551630616188,0.05644511431455612,0.10322180390357971,0.06975360959768295,0.09596749395132065,0.03322838991880417,0.04990879073739052,0.052366241812705994,0.058351773768663406,0.02170639857649803,0.05095591023564339,0.06291802227497101,0.08049730211496353,0.052886929363012314,0.029531480744481087,0.04901594668626785,0.04248941317200661,0.03267538920044899,0.11277633160352707,0.07595176249742508,0.05471852049231529,0.06818460673093796,0.06591679900884628,0.06233663856983185,0.1119614988565445,0.061102841049432755,0.06158360838890076,0.0614069327712059,0.07061170041561127,0.049030888825654984,0.05740385875105858,0.05831780284643173,0.033847589045763016,0.02070276066660881,0.0413120836019516,0.039849478751420975,0.0686665028333664,0.055854134261608124,0.04990406334400177,0.07745364308357239,0.03753338009119034,0.052956849336624146,0.0680987760424614,0.10046352446079254,0.08623306453227997,0.09316089749336243,0.07838750630617142,0.03752858191728592,0.06832840293645859,0.08101247251033783,0.04534367099404335,0.05110030621290207,0.09424614161252975,0.03483819589018822,0.07445500046014786,0.0960933119058609,0.09477156400680542,0.10500931739807129,0.09312767535448074,0.057954881340265274,0.04642568156123161,0.12933053076267242,0.08016075193881989,0.08744766563177109,0.09953619539737701,0.08197365701198578,0.06266799569129944,0.0593346506357193,0.043841201812028885,0.08982209116220474,0.018635401502251625,0.026330893859267235,0.0365036204457283,0.032245974987745285,0.054635126143693924,0.059610649943351746,0.08637778460979462,0.07612722367048264,0.03317184001207352,0.04291820153594017,0.14127884805202484,0.04063539579510689,0.06267020106315613,0.06418431550264359,0.06741990149021149,0.05182348191738129,0.03228757157921791,0.07448813319206238,0.032875511795282364,0.06810840219259262,0.055718883872032166,0.05496138334274292,0.05495503917336464,0.0352599062025547,0.05593151971697807,0.07317943125963211,0.08240243047475815,0.04790252447128296,0.06301150470972061,0.06653960049152374,0.038492634892463684,0.09371551871299744,0.06466268002986908,0.02006629854440689,0.06754342466592789,0.05736646056175232,0.04579578712582588,0.07333163172006607,0.09382215142250061,0.03486158326268196,0.025334391742944717,0.06423130631446838,0.044780585914850235,0.06095248833298683,0.0760565921664238,0.07516811043024063,0.11051690578460693,0.1477041393518448,0.11460919678211212,0.10575969517230988,0.05265505239367485,0.12120513617992401,0.06858006864786148,0.08917687833309174,0.04905537888407707,0.09061174094676971,0.08889814466238022,0.04676762968301773,0.05314967408776283,0.039530735462903976,0.0654861181974411,0.04495702311396599,0.07545493543148041,0.04426800087094307,0.04904073104262352,0.03348357602953911,0.04759258031845093,0.09637906402349472,0.03253832831978798,0.04076884686946869,0.07871972769498825,0.017988096922636032,0.09516908973455429,0.06380438059568405,0.04625733196735382,0.04758746922016144,0.05635112524032593,0.06790778785943985,0.015059414319694042,0.0900278091430664,0.06659656763076782,0.05199078842997551,0.07143259048461914,0.06661099940538406,0.02877957373857498,0.05034782364964485,0.10135800391435623,0.056126318871974945,0.04284336417913437,0.061311956495046616,0.0631408542394638,0.032138895243406296,0.06896190345287323,0.09348365664482117,0.06063058227300644,0.05282486230134964,0.07328043133020401,0.06127948313951492,0.016816074028611183]

# This is up to epoch 9

# Determine the window size for smoothing
smoothed_size = math.floor(len(losses) * smoothing_percent)
if smoothed_size < 1:
    smoothed_size = 1

# Compute smoothed losses by averaging each group of smoothed_size losses
smoothed_losses = []
rolling_sum = 0
rolling_count = 0
for loss in losses:
    rolling_sum += loss
    rolling_count += 1
    if rolling_count >= smoothed_size:
        smoothed_losses.append(rolling_sum / rolling_count)
        rolling_sum = 0
        rolling_count = 0

# Create a list of epoch values for plotting based on the smoothed losses
epoch_values = list(range(len(smoothed_losses)))

# Plot the losses
plt.plot(epoch_values, smoothed_losses, marker='o')
plt.xlabel("Epoch (smoothed)")
plt.ylabel("Loss")
plt.title("Smoothed Training Loss per Epoch")
plt.show()